$(document).ready(function(){$(".select2").each(function(b,a){b=$(a).data("placeholder");$(a).select2({placeholder:b,maximumSelectionLength:3}).on("select2:unselect",function(a){removeUnselectedData($(this).attr("id"),a.params.data.id)}).on("select2:select",function(a){a=$(a.params.data.element);a.detach();$(this).append(a);$(this).trigger("change")})});$("#profile_upload").click(function(){$("#my_propic").trigger("click")});$("#my_propic").change(function(){tempFile=this;$("#preview_image").modal("show");
if(tempFile.files&&tempFile.files[0]){var b=new FileReader;b.onload=function(a){$("#preview_image .preview").attr("src",a.target.result)};b.readAsDataURL(tempFile.files[0])}return!0});$("#module1").on("change",function(){$.ajax({url:base_url+"ajax-call/Features/getSecondModule",type:"POST",data:{module1:$(this).val()},success:function(b){$("#module2").empty();$("#module2").append("<option value='' disabled selected>Select Second Module</option>");for(i=0;i<b.data.length;i++)$("#module2").append("<option value="+
b.data[i].name+">"+b.data[i].name+"</option>")}})});$("#module2").on("change",function(){$.ajax({url:base_url+"ajax-call/Features/getThirdModule",type:"POST",data:{module2:$(this).val(),module1:$("#module1").val()},success:function(b){$("#module3").empty();$("#module3").append("<option value='' disabled selected>Select Third Module</option>");for(i=0;i<b.data.length;i++)$("#module3").append("<option value="+b.data[i].name+">"+b.data[i].name+"</option>")}})});$("#facility_list").on("change",function(){var b=
$(this).val();$.ajax({url:base_url+"ajax-call/Features/getManagersOfFacility",type:"POST",data:{fac_id:b},success:function(a){$("#project_manager").empty();$("#project_manager").append("<option value='' disabled selected>Select Facility Location Manager</option>");for(i=0;i<a.data.length;i++)$("#project_manager").append("<option value="+a.data[i].user_id+">"+a.data[i].first_name+" "+a.data[i].last_name+"</option>")}})});$("#fac_id").on("change",function(){var b=$(this).val();$.ajax({url:base_url+
"ajax-call/Features/getLocationOfFacility",type:"POST",data:{fac_id:b},success:function(a){$("#locations").empty();$("#locations").append("<option value='' disabled selected>Select Location</option>");for(i=0;i<a.data.length;i++)$("#locations").append("<option value="+a.data[i].location_id+">"+a.data[i].name+"</option>")}})});$(".consultant_dependent").css("display","none");$("#consultant_num").on("keyup",function(){0==$(this).val()?($(".consultant_dependent").attr("disabled",!0),$(".consultant_dependent").css("display",
"none")):($(".consultant_dependent").attr("disabled",!1),$(".consultant_dependent").css("display","block"))});$("#calendar").fullCalendar({themeSystem:"bootstrap4",header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},height:800,width:500,titleRangeSeparator:"-",defaultView:"month",displayEventTime:!1,eventSources:[{url:base_url+"ajax-call/Features/loadShifts/"+$("#calendar").data("location"),color:"#4545bc"}],selectable:!0,selectHelper:!0,allDaySlot:!1,timezone:"local",
selectAllow:function(b){return 0>=moment().subtract(1,"days").diff(b.start)},eventClick:function(b){$("#myModal").modal();$.ajax({url:base_url+"ajax-call/Features/getEventDetails",type:"POST",data:{id:b.id},success:function(a){console.log(a.data);$("#consultants").empty();$("#super_users").empty();for(i=0;i<a.data.consultants.length;i++)$("#consultants").append("<option value='"+a.data.consultants[i].user_id+"'>"+a.data.consultants[i].first_name+" "+a.data.consultants[i].last_name+"</option>");for(i=
0;i<a.data.super_users.length;i++)$("#super_users").append("<option value='"+a.data.super_users[i].user_id+"'>"+a.data.super_users[i].first_name+" "+a.data.super_users[i].last_name+"</option>");for(i=0;i<a.data.shift.length;i++)"consultant"==a.data.shift[i].type&&$('#consultants option[value="'+a.data.shift[i].user_id+'"]').prop("selected",!0),"super_user"==a.data.shift[i].type&&$('#super_users option[value="'+a.data.shift[i].user_id+'"]').prop("selected",!0);$("#consultants").select2({maximumSelectionLength:a.data.shift[0].number_const});
$("#super_users").select2({maximumSelectionLength:a.data.shift[0].number_su});$("#event_id").val(a.data.shift[0].event_id)}})},editable:!1});$(".updateFacLocMangr").on("click",function(){console.log($(this).closest("tr").find("select").val());console.log($(this).closest("tr").find("td .phone").val());console.log($(this).data("id"));$.ajax({url:base_url+"ajax-call/Features/updateFacLocMng",type:"POST",data:{user_id:$(this).data("id"),phone:$(this).closest("tr").find("td .phone").val(),location_id:$(this).closest("tr").find("select").val()},
success:function(){window.location.reload()}})});$("#s_lname").on("keyup",function(){$("#s_uname").val($("#s_lname").val()+"."+$("#s_fname").val())});$(".update_su").on("click",function(){$.ajax({url:base_url+"ajax-call/Features/updateSuser",type:"POST",data:{user_id:$(this).data("id"),location_id:$(this).closest("tr").find("select").val(),shift:$(this).closest("tr").find(".shift").val()},success:function(){}})})});
function saveDemeanor(b){var a=$("select[data-user_id="+b+"]").val();$.ajax({url:base_url+"ajax-call/Features/saveDemeanor",type:"POST",data:{rating:a,user_id:b},success:function(){Swal.fire({title:"Success",text:"Demeanor Rating save",icon:"success",confirmButtonText:"OK"})}})}
function upload_image(){let b=new FormData,a=base_url+"ajax-call/Features/user_profile_update";$("#siteLoader").fadeIn();b.append("user_image",$("#my_propic")[0].files[0]);b.append("type","teacher_profile");$.ajax({type:"post",url:a,processData:!1,contentType:!1,data:b,success:function(a){$("#siteLoader").fadeOut();if(a.success){if(tempFile.files&&tempFile.files[0]){var b=new FileReader;b.onload=function(a){$(".profile-info .image img").attr("src",a.target.result)};b.readAsDataURL(tempFile.files[0])}tempFile=
null}console.log(a.msg)},error:function(a){$("#siteLoader").fadeOut();console.log(a)}})}function updateRating(b,a,c){console.log(b);console.log(a);console.log(c);$.ajax({url:base_url+"ajax-call/Features/saveRating",type:"POST",data:{rating_num:b,user_id:a,rating_val:c},success:function(){}})};